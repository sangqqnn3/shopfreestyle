<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - LUXE DROPSHIP</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <style>
        .admin-container {
            max-width: 1400px;
            margin: 180px auto 2rem;
            padding: 2rem;
        }
        
        /* Ensure admin doesn't conflict with new header */
        body.admin-page .top-header {
            display: none !important;
        }
        
        body.admin-page .main-nav {
            display: none !important;
        }
        
        body.admin-page .promo-banner {
            display: none !important;
        }
        
        body.admin-page {
            padding-top: 0;
            margin-top: 0;
        }
        
        body.admin-page .admin-container {
            margin-top: 2rem;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .admin-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--border-color);
        }

        .admin-tab {
            padding: 1rem 2rem;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .admin-tab.active {
            border-bottom-color: var(--primary-color);
            color: var(--primary-color);
        }

        .admin-content {
            display: none;
        }

        .admin-content.active {
            display: block;
        }

        .data-table {
            width: 100%;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .data-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .data-table th {
            background: #f8f9fa;
            font-weight: 600;
        }

        .data-table tr:hover {
            background: #f8f9fa;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            margin: 0 0.25rem;
        }

        .btn-edit {
            background: var(--primary-color);
            color: white;
        }

        .btn-delete {
            background: #e74c3c;
            color: white;
        }

        .btn-add {
            background: #27ae60;
            color: white;
        }

        .modal-form {
            display: none;
        }

        .modal-form.active {
            display: block;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            max-width: 1200px;
            width: 95%;
            max-height: 95vh;
            overflow-y: auto;
        }

        .modal-content h2 {
            margin-top: 0;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e0e0e0;
        }

        .color-input-group {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .color-preview {
            width: 40px;
            height: 40px;
            border-radius: 4px;
            border: 2px solid #ddd;
            cursor: pointer;
        }

        .gallery-images {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .gallery-item {
            position: relative;
            border: 2px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }

        .gallery-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }

        .gallery-item .remove-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(231, 76, 60, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .add-image-btn {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            background: #f8f9fa;
            transition: all 0.3s;
        }

        .add-image-btn:hover {
            border-color: #333;
            background: #e9ecef;
        }

        .tag-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .tag {
            background: #333;
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tag .remove-tag {
            cursor: pointer;
            font-weight: bold;
        }

        /* Order Details Modal */
        .order-details-modal {
            max-width: 900px;
            width: 95%;
        }

        .order-detail-section {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }

        .order-detail-section h4 {
            margin-top: 0;
            margin-bottom: 1rem;
            font-size: 1.1rem;
            font-weight: 700;
            border-bottom: 2px solid #333;
            padding-bottom: 0.5rem;
        }

        .detail-item {
            display: flex;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            background: white;
            border-radius: 4px;
        }

        .detail-label {
            font-weight: 600;
            width: 150px;
            flex-shrink: 0;
            color: #666;
        }

        .detail-value {
            flex: 1;
            color: #333;
        }

        .detail-copy-btn {
            background: #333;
            color: white;
            border: none;
            padding: 0.3rem 0.8rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
            margin-left: 0.5rem;
            transition: background 0.3s;
        }

        .detail-copy-btn:hover {
            background: #555;
        }

        .copy-all-btn {
            width: 100%;
            padding: 1rem;
            background: #27ae60;
            color: white;
            border: none;
            border-radius: 5px;
            font-weight: 600;
            cursor: pointer;
            font-size: 1.1rem;
            margin-top: 1rem;
        }

        .copy-all-btn:hover {
            background: #229954;
        }

        .copy-all-btn i {
            margin-right: 0.5rem;
        }

        .order-items-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .order-items-table th,
        .order-items-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .order-items-table th {
            background: #f8f9fa;
            font-weight: 600;
        }

        .order-items-table img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 4px;
        }

        .copy-status {
            display: inline-block;
            margin-left: 0.5rem;
            color: #27ae60;
            font-size: 0.9rem;
        }

        .copy-status.hidden {
            display: none;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            font-size: 0.9rem;
            color: #333;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.95rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #333;
        }

        .form-section {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }

        .form-section h4 {
            margin-top: 0;
            margin-bottom: 1rem;
            font-size: 1.1rem;
            font-weight: 700;
            border-bottom: 2px solid #333;
            padding-bottom: 0.5rem;
        }

        .form-section.full-width {
            grid-column: 1 / -1;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .image-preview {
            max-width: 200px;
            margin-top: 1rem;
            border-radius: 8px;
            border: 2px solid #ddd;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-info {
            background: #17a2b8;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-primary {
            background: #333;
            color: white;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px solid #e0e0e0;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .stat-label {
            color: #666;
            margin-top: 0.5rem;
        }
        
        /* Product Details Tabs */
        .product-details-tabs {
            margin-top: 1rem;
        }
        
        .details-tabs-header {
            display: flex;
            gap: 0;
            border-bottom: 2px solid #e0e0e0;
            margin-bottom: 1.5rem;
        }
        
        .details-tab-btn {
            background: none;
            border: none;
            padding: 1rem 1.5rem;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            color: #666;
            position: relative;
            top: 2px;
        }
        
        .details-tab-btn:hover {
            color: #333;
            background: #f8f9fa;
        }
        
        .details-tab-btn.active {
            color: #333;
            border-bottom-color: #333;
            font-weight: 600;
        }
        
        .details-tab-content {
            display: none;
        }
        
        .details-tab-content.active {
            display: block;
        }
        
        .specs-form {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
        }
        
        .specs-form .form-group {
            margin-bottom: 1rem;
        }
        
        .specs-form small {
            display: block;
            margin-top: 0.5rem;
            font-size: 0.85rem;
        }
        
        /* Reviews Admin Section */
        .reviews-admin-section {
            background: #fff;
        }
        
        .add-review-form {
            border: 1px solid #ddd;
        }
        
        .reviews-list {
            max-height: 500px;
            overflow-y: auto;
        }
        
        .review-item-admin {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            border: 1px solid #e5e5e5;
        }
        
        .review-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .review-item-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .review-item-name {
            font-weight: 600;
            color: #333;
        }
        
        .review-item-stars {
            color: #ffc107;
        }
        
        .review-item-date {
            color: #666;
            font-size: 0.85rem;
        }
        
        .review-item-verified {
            background: #27ae60;
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .review-item-comment {
            color: #333;
            margin-top: 0.5rem;
            line-height: 1.6;
        }
        
        .review-item-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .btn-sm {
            padding: 0.4rem 0.8rem;
            font-size: 0.85rem;
        }
    </style>
</head>
<body class="admin-page">
    <div class="admin-container">
        <div class="admin-header">
            <h1>Admin Panel</h1>
            <div>
                <a href="index.html" class="btn" style="background: #333; color: white; text-decoration: none;">
                    <i class="fas fa-home"></i> Back to Site
                </a>
                <button class="btn btn-delete" onclick="auth.logout(); window.location.href='index.html';">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>

        <div class="admin-tabs">
            <button class="admin-tab active" onclick="showTab('dashboard', this)">Dashboard</button>
            <button class="admin-tab" onclick="showTab('users', this)">Users</button>
            <button class="admin-tab" onclick="showTab('products', this)">Products</button>
            <button class="admin-tab" onclick="showTab('coupons', this)">Coupons</button>
            <button class="admin-tab" onclick="showTab('orders', this)">Orders</button>
            <button class="admin-tab" onclick="showTab('aliexpress', this)">AliExpress Import</button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="admin-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalUsers">0</div>
                    <div class="stat-label">Total Users</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalProducts">0</div>
                    <div class="stat-label">Total Products</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalOrders">0</div>
                    <div class="stat-label">Total Orders</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalRevenue">$0</div>
                    <div class="stat-label">Total Revenue</div>
                </div>
            </div>
        </div>

        <!-- Users Tab -->
        <div id="users" class="admin-content">
            <div style="margin-bottom: 1rem;">
                <button class="btn btn-add" onclick="showUserForm()">
                    <i class="fas fa-plus"></i> Add User
                </button>
            </div>
            <div class="data-table">
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Created</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="usersTableBody">
                        <!-- Users loaded dynamically -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Products Tab -->
        <div id="products" class="admin-content">
            <div style="margin-bottom: 1rem;">
                <button class="btn btn-add" onclick="showProductForm()">
                    <i class="fas fa-plus"></i> Add Product
                </button>
            </div>
            <div class="data-table">
                <table>
                    <thead>
                        <tr>
                            <th>Image</th>
                            <th>Name (EN)</th>
                            <th>Name (VI)</th>
                            <th>Price</th>
                            <th>Category</th>
                            <th>Stock</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="productsTableBody">
                        <!-- Products loaded dynamically -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Orders Tab -->
        <div id="orders" class="admin-content">
            <div class="data-table">
                <table>
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Customer</th>
                            <th>Items</th>
                            <th>Total</th>
                            <th>Status</th>
                            <th>Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="ordersTableBody">
                        <!-- Orders loaded dynamically -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- AliExpress Import Tab -->
        <div id="aliexpress" class="admin-content">
            <div class="aliexpress-header">
                <h2><i class="fab fa-alipay"></i> AliExpress Dropship Import</h2>
                <p>Import products from AliExpress with full product details and images</p>
            </div>

            <!-- Search Section -->
            <div class="search-section">
                <div class="search-box">
                    <div class="form-group">
                        <label><i class="fas fa-link"></i> AliExpress Product URL:</label>
                        <div class="url-input-group">
                            <input type="url" id="aliexpressUrl" placeholder="https://www.aliexpress.com/item/..." class="url-input">
                            <button class="btn btn-primary" onclick="searchAliExpressProduct()">
                                <i class="fas fa-search"></i> Fetch Product
                            </button>
                        </div>
                    </div>
                </div>

                <!-- API Status -->
                <div class="api-status">
                    <div class="status-indicator" id="apiStatus">
                        <i class="fas fa-circle"></i>
                        <span>API Status: Ready</span>
                    </div>
                </div>
            </div>

            <!-- Product Preview Section -->
            <div id="productPreview" class="product-preview hidden">
                <h3><i class="fas fa-eye"></i> Product Preview</h3>
                <div class="preview-container">
                    <div class="preview-images">
                        <div class="main-image">
                            <img id="previewMainImage" src="" alt="Product Image">
                        </div>
                        <div class="thumbnail-gallery" id="thumbnailGallery">
                            <!-- Thumbnails loaded here -->
                        </div>
                    </div>
                    <div class="preview-details">
                        <h4 id="previewTitle">Product Title</h4>
                        <div class="price-section">
                            <span class="original-price" id="previewOriginalPrice">$0.00</span>
                            <span class="sale-price" id="previewSalePrice">$0.00</span>
                            <span class="discount" id="previewDiscount">0% OFF</span>
                        </div>
                        <div class="rating-section">
                            <div class="stars" id="previewRating">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="rating-text" id="previewRatingText">(0 reviews)</span>
                        </div>
                        <div class="product-specs" id="previewSpecs">
                            <!-- Product specifications loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Import Form Section -->
            <div class="import-form-section">
                <h3><i class="fas fa-edit"></i> Edit & Import Product</h3>
                <form onsubmit="importAliExpressProduct(event)" id="aliexpressForm">
                    <div class="form-grid">
                        <div class="form-section">
                            <h4>Basic Information</h4>
                            <div class="form-group">
                                <label>Product Name (English):</label>
                                <input type="text" id="aliexpressNameEn" required>
                            </div>
                            <div class="form-group">
                                <label>Product Name (Vietnamese):</label>
                                <input type="text" id="aliexpressNameVi" required>
                            </div>
                            <div class="form-group">
                                <label>Category:</label>
                                <select id="aliexpressCategory" required>
                                    <option value="women-watches">Women's Watches</option>
                                    <option value="men-watches">Men's Watches</option>
                                    <option value="jewelry">Jewelry</option>
                                    <option value="bags">Bags</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-section">
                            <h4>Pricing & Inventory</h4>
                            <div class="form-group">
                                <label>Your Selling Price (USD):</label>
                                <input type="number" id="aliexpressPrice" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label>AliExpress Price (USD):</label>
                                <input type="number" id="aliexpressOriginalPrice" step="0.01" readonly>
                            </div>
                            <div class="form-group">
                                <label>Profit Margin:</label>
                                <input type="text" id="profitMargin" readonly>
                            </div>
                            <div class="form-group">
                                <label>Stock Quantity:</label>
                                <input type="number" id="aliexpressStock" required>
                            </div>
                        </div>

                        <div class="form-section">
                            <h4>Images</h4>
                            <div class="image-upload-section">
                                <div class="main-image-upload">
                                    <label>Main Image URL:</label>
                                    <input type="url" id="aliexpressImage" required>
                                    <button type="button" class="btn btn-secondary" onclick="previewImage('aliexpressImage')">
                                        <i class="fas fa-eye"></i> Preview
                                    </button>
                                </div>
                                <div class="gallery-upload">
                                    <label>Additional Images (one per line):</label>
                                    <textarea id="aliexpressGallery" rows="4" placeholder="https://example.com/image1.jpg&#10;https://example.com/image2.jpg"></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="form-section full-width">
                            <h4>Descriptions</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Description (English):</label>
                                    <textarea id="aliexpressDescEn" rows="4"></textarea>
                                </div>
                                <div class="form-group">
                                    <label>Description (Vietnamese):</label>
                                    <textarea id="aliexpressDescVi" rows="4"></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="form-section full-width">
                            <h4>SEO & Marketing</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Keywords (comma separated):</label>
                                    <input type="text" id="aliexpressKeywords" placeholder="watch, luxury, gold, premium">
                                </div>
                                <div class="form-group">
                                    <label>Product Tags:</label>
                                    <input type="text" id="aliexpressTags" placeholder="bestseller, new, limited">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="clearAliExpressForm()">
                            <i class="fas fa-trash"></i> Clear Form
                        </button>
                        <button type="button" class="btn btn-info" onclick="saveAsDraft()">
                            <i class="fas fa-save"></i> Save as Draft
                        </button>
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-upload"></i> Import Product
                        </button>
                    </div>
                </form>
            </div>

            <!-- Import History -->
            <div class="import-history">
                <h3><i class="fas fa-history"></i> Recent Imports</h3>
                <div class="history-list" id="importHistory">
                    <!-- Import history loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- User Form Modal -->
    <div id="userForm" class="modal-form" onclick="if(event.target.id === 'userForm') closeUserForm()">
        <div class="modal-content">
            <h2 id="userFormTitle">Add User</h2>
            <form onsubmit="saveUser(event)">
                <input type="hidden" id="userId">
                <div class="form-group">
                    <label>Name:</label>
                    <input type="text" id="userName" required>
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="userEmail" required>
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="password" id="userPassword">
                </div>
                <div class="form-group">
                    <label>Role:</label>
                    <select id="userRole" required>
                        <option value="customer">Customer</option>
                        <option value="admin">Admin</option>
                    </select>
                </div>
                <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                    <button type="submit" class="btn btn-add" style="flex: 1;">Save</button>
                    <button type="button" class="btn" onclick="closeUserForm()" style="flex: 1;">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Product Form Modal -->
    <div id="productForm" class="modal-form" onclick="if(event.target.id === 'productForm') closeProductForm()">
        <div class="modal-content">
            <h2 id="productFormTitle">Add Product</h2>
            <form onsubmit="saveProduct(event)">
                <input type="hidden" id="productId">
                
                <div class="form-grid">
                    <!-- Basic Information -->
                    <div class="form-section">
                        <h4><i class="fas fa-info-circle"></i> Basic Information</h4>
                        <div class="form-group">
                            <label>SKU:</label>
                            <input type="text" id="productSKU" placeholder="Auto-generated" readonly>
                        </div>
                        <div class="form-group">
                            <label>Product Name (English):</label>
                            <input type="text" id="productNameEn" required>
                        </div>
                        <div class="form-group">
                            <label>Product Name (Vietnamese):</label>
                            <input type="text" id="productNameVi" required>
                        </div>
                        <div class="form-group">
                            <label>Category:</label>
                            <select id="productCategory" required>
                                <option value="women-watches">Women's Watches</option>
                                <option value="men-watches">Men's Watches</option>
                                <option value="jewelry">Jewelry</option>
                                <option value="bags">Bags</option>
                            </select>
                        </div>
                    </div>

                    <!-- Pricing & Inventory -->
                    <div class="form-section">
                        <h4><i class="fas fa-dollar-sign"></i> Pricing & Inventory</h4>
                        <div class="form-group">
                            <label>Price (USD):</label>
                            <input type="number" id="productPrice" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label>Original Price (USD):</label>
                            <input type="number" id="productOriginalPrice" step="0.01" placeholder="For discount display">
                        </div>
                        <div class="form-group">
                            <label>Stock Quantity:</label>
                            <input type="number" id="productStock" required>
                        </div>
                        <div class="form-group">
                            <label>Weight (kg):</label>
                            <input type="number" id="productWeight" step="0.01" placeholder="For shipping">
                        </div>
                    </div>

                    <!-- Product Variants -->
                    <div class="form-section full-width">
                        <h4><i class="fas fa-palette"></i> Product Variants</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Available Colors (hex code or name):</label>
                                <div style="display: flex; align-items: center; gap: 0.5rem;">
                                    <input type="text" id="productColorInput" placeholder="#FF0000 or Red" style="flex: 1;">
                                    <button type="button" class="btn btn-secondary" onclick="addColor()">
                                        <i class="fas fa-plus"></i> Add
                                    </button>
                                </div>
                                <div id="colorsList" class="tag-list">
                                    <!-- Colors will appear here -->
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Available Sizes (comma separated):</label>
                                <input type="text" id="productSizes" placeholder="S, M, L, XL">
                            </div>
                        </div>
                    </div>

                    <!-- Images -->
                    <div class="form-section full-width">
                        <h4><i class="fas fa-images"></i> Product Images</h4>
                        <div class="form-group">
                            <label>Main Image URL:</label>
                            <input type="url" id="productImage" required>
                        </div>
                        <div class="gallery-upload">
                            <label>Additional Images (Gallery):</label>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="url" id="galleryImageInput" placeholder="Image URL" style="flex: 1;">
                                <button type="button" class="btn btn-secondary" onclick="addGalleryImage()">
                                    <i class="fas fa-plus"></i> Add Image
                                </button>
                            </div>
                            <div id="galleryImages" class="gallery-images">
                                <!-- Gallery images will appear here -->
                            </div>
                        </div>
                    </div>

                    <!-- Shipping -->
                    <div class="form-section">
                        <h4><i class="fas fa-shipping-fast"></i> Shipping</h4>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="productFreeShip" onchange="toggleShippingFee()">
                                Free Shipping
                            </label>
                        </div>
                        <div class="form-group" id="shippingFeeGroup">
                            <label>Shipping Fee (USD):</label>
                            <input type="number" id="productShippingFee" step="0.01" value="0">
                        </div>
                        <div class="form-group">
                            <label>Estimated Delivery Days:</label>
                            <input type="number" id="productDeliveryDays" value="5">
                        </div>
                    </div>

                    <!-- Marketing & Discount -->
                    <div class="form-section">
                        <h4><i class="fas fa-tags"></i> Marketing & Discount</h4>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="productIsNew">
                                Mark as New Product
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="productIsHot">
                                Mark as Hot/Bestseller
                            </label>
                        </div>
                        <div class="form-group">
                            <label>Discount Coupon Code:</label>
                            <select id="productCouponCode">
                                <option value="">No coupon</option>
                                <!-- Coupons loaded dynamically -->
                            </select>
                        </div>
                    </div>

                    <!-- Product Details Tabs -->
                    <div class="form-section full-width">
                        <div class="product-details-tabs">
                            <div class="details-tabs-header">
                                <button type="button" class="details-tab-btn active" onclick="switchDetailsTab('description')">
                                    Description
                                </button>
                                <button type="button" class="details-tab-btn" onclick="switchDetailsTab('specifications')">
                                    Specifications
                                </button>
                                <button type="button" class="details-tab-btn" onclick="switchDetailsTab('reviews')">
                                    Reviews
                                </button>
                                <button type="button" class="details-tab-btn" onclick="switchDetailsTab('shipping-returns')">
                                    Shipping & Returns
                                </button>
                            </div>
                            
                            <!-- Description Tab -->
                            <div class="details-tab-content active" id="tabDescription">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Description (English):</label>
                                        <textarea id="productDescEn" rows="6"></textarea>
                                    </div>
                                    <div class="form-group">
                                        <label>Description (Vietnamese):</label>
                                        <textarea id="productDescVi" rows="6"></textarea>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Specifications Tab -->
                            <div class="details-tab-content" id="tabSpecifications">
                                <div class="specs-form">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Brand:</label>
                                            <input type="text" id="specBrand" placeholder="e.g., Shop Free Style">
                                        </div>
                                        <div class="form-group">
                                            <label>Model:</label>
                                            <input type="text" id="specModel" placeholder="e.g., SFS-W100">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Case Material:</label>
                                            <input type="text" id="specCaseMaterial" placeholder="e.g., Stainless Steel">
                                        </div>
                                        <div class="form-group">
                                            <label>Case Size:</label>
                                            <input type="text" id="specCaseSize" placeholder="e.g., 36mm">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Band Material:</label>
                                            <input type="text" id="specBandMaterial" placeholder="e.g., Genuine Leather">
                                        </div>
                                        <div class="form-group">
                                            <label>Band Width:</label>
                                            <input type="text" id="specBandWidth" placeholder="e.g., 18mm">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Movement:</label>
                                            <input type="text" id="specMovement" placeholder="e.g., Japanese Quartz">
                                        </div>
                                        <div class="form-group">
                                            <label>Water Resistance:</label>
                                            <input type="text" id="specWaterResistance" placeholder="e.g., 30 meters">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Warranty:</label>
                                            <input type="text" id="specWarranty" placeholder="e.g., 2 years">
                                        </div>
                                        <div class="form-group">
                                            <label>Additional Specs (comma separated):</label>
                                            <input type="text" id="specAdditional" placeholder="e.g., Crystal: Mineral, Dial: White">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>Custom Specifications (JSON format for advanced users):</label>
                                        <textarea id="specCustom" rows="4" placeholder='{"Display": "Analog", "Battery": "CR2032"}'></textarea>
                                        <small style="color: #666;">Leave empty if using fields above. Use JSON format: {"key": "value"}</small>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Reviews Tab -->
                            <div class="details-tab-content" id="tabReviews">
                                <div class="reviews-admin-section">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                                        <h4 style="margin: 0;"><i class="fas fa-star"></i> Product Reviews</h4>
                                        <div style="display: flex; gap: 0.5rem;">
                                            <button type="button" class="btn btn-secondary" onclick="generateRandomReviews()">
                                                <i class="fas fa-random"></i> Generate Random Reviews
                                            </button>
                                            <button type="button" class="btn btn-add" onclick="showAddReviewForm()">
                                                <i class="fas fa-plus"></i> Add Review
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- Add Review Form -->
                                    <div id="addReviewForm" class="add-review-form" style="display: none; background: #f8f9fa; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;">
                                        <h5 style="margin-top: 0;">Add New Review</h5>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label>Reviewer Name:</label>
                                                <input type="text" id="reviewName" placeholder="e.g., Sarah M.">
                                            </div>
                                            <div class="form-group">
                                                <label>Rating (1-5):</label>
                                                <select id="reviewRating">
                                                    <option value="5">5 Stars</option>
                                                    <option value="4">4 Stars</option>
                                                    <option value="3">3 Stars</option>
                                                    <option value="2">2 Stars</option>
                                                    <option value="1">1 Star</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Review Comment:</label>
                                            <textarea id="reviewComment" rows="3" placeholder="Write your review here..."></textarea>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label>Review Date:</label>
                                                <input type="date" id="reviewDate">
                                            </div>
                                            <div class="form-group">
                                                <label>Verified Purchase:</label>
                                                <label style="display: flex; align-items: center; gap: 0.5rem; margin-top: 0.5rem;">
                                                    <input type="checkbox" id="reviewVerified">
                                                    <span>Mark as verified purchase</span>
                                                </label>
                                            </div>
                                        </div>
                                        <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                                            <button type="button" class="btn btn-success" onclick="addReview()">
                                                <i class="fas fa-save"></i> Add Review
                                            </button>
                                            <button type="button" class="btn btn-secondary" onclick="cancelAddReview()">
                                                Cancel
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- Reviews List -->
                                    <div id="reviewsList" class="reviews-list">
                                        <p style="color: #666; text-align: center; padding: 2rem;">No reviews yet. Add your first review!</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Shipping & Returns Tab -->
                            <div class="details-tab-content" id="tabShippingReturns">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Shipping Information:</label>
                                        <textarea id="productShippingInfo" rows="4" placeholder="Free Standard Shipping&#10;Delivery time: 5-7 business days&#10;We ship to most countries worldwide"></textarea>
                                    </div>
                                    <div class="form-group">
                                        <label>Returns & Warranty Information:</label>
                                        <textarea id="productReturnsInfo" rows="4" placeholder="30-Day Return Policy&#10;Items must be in original condition&#10;2-Year Warranty included"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SEO -->
                    <div class="form-section full-width">
                        <h4><i class="fas fa-search"></i> SEO & Keywords</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Meta Keywords (comma separated):</label>
                                <input type="text" id="productKeywords" placeholder="watch, luxury, gold">
                            </div>
                            <div class="form-group">
                                <label>Tags:</label>
                                <input type="text" id="productTagsInput" placeholder="bestseller, new">
                            </div>
                        </div>
                        <div id="tagsList" class="tag-list">
                            <!-- Tags will appear here -->
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeProductForm()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-save"></i> Save Product
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Coupons Tab -->
    <div id="coupons" class="admin-content">
        <div style="margin-bottom: 1rem;">
            <button class="btn btn-add" onclick="showCouponForm()">
                <i class="fas fa-plus"></i> Add Coupon
            </button>
        </div>
        <div class="data-table">
            <table>
                <thead>
                    <tr>
                        <th>Code</th>
                        <th>Type</th>
                        <th>Value</th>
                        <th>Min Purchase</th>
                        <th>Usage Limit</th>
                        <th>Expiry Date</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="couponsTableBody">
                    <!-- Coupons loaded dynamically -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Coupon Form Modal -->
    <div id="couponForm" class="modal-form" onclick="if(event.target.id === 'couponForm') closeCouponForm()">
        <div class="modal-content" style="max-width: 600px;">
            <h2 id="couponFormTitle">Add Coupon</h2>
            <form onsubmit="saveCoupon(event)">
                <input type="hidden" id="couponId">
                <div class="form-row">
                    <div class="form-group">
                        <label>Coupon Code:</label>
                        <input type="text" id="couponCode" required style="text-transform: uppercase;">
                    </div>
                    <div class="form-group">
                        <label>Discount Type:</label>
                        <select id="couponType" required onchange="toggleCouponValueLabel()">
                            <option value="percentage">Percentage (%)</option>
                            <option value="fixed">Fixed Amount ($)</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label id="couponValueLabel">Discount Value:</label>
                        <input type="number" id="couponValue" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label>Minimum Purchase (USD):</label>
                        <input type="number" id="couponMinPurchase" step="0.01" value="0">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Usage Limit:</label>
                        <input type="number" id="couponUsageLimit" placeholder="Unlimited">
                    </div>
                    <div class="form-group">
                        <label>Expiry Date:</label>
                        <input type="date" id="couponExpiryDate" required>
                    </div>
                </div>
                <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                    <button type="submit" class="btn btn-add" style="flex: 1;">Save</button>
                    <button type="button" class="btn" onclick="closeCouponForm()" style="flex: 1;">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Order Details Modal -->
    <div id="orderDetailsModal" class="modal-form" onclick="if(event.target.id === 'orderDetailsModal') closeOrderDetails()">
        <div class="modal-content order-details-modal">
            <h2 id="orderDetailsTitle">Order Details</h2>
            <div id="orderDetailsContent">
                <!-- Order details loaded here -->
            </div>
            <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                <button class="copy-all-btn" onclick="copyAllOrderInfo()">
                    <i class="fas fa-copy"></i> Copy All Information
                </button>
                <button class="btn" onclick="closeOrderDetails()" style="flex: 1;">Close</button>
            </div>
        </div>
    </div>

    <script src="js/database.js"></script>
    <script src="js/i18n.js"></script>
    <script src="js/auth.js"></script>
    <script>
        // Switch between product details tabs
        function switchDetailsTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.details-tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.details-tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            const tabContent = document.getElementById('tab' + tabName.charAt(0).toUpperCase() + tabName.slice(1));
            if (tabContent) {
                tabContent.classList.add('active');
            }
            
            // Activate corresponding button
            const buttons = document.querySelectorAll('.details-tab-btn');
            const tabMap = {
                'description': 0,
                'specifications': 1,
                'reviews': 2,
                'shipping-returns': 3
            };
            buttons.forEach((btn, index) => {
                if (index === (tabMap[tabName] || 0)) {
                    btn.classList.add('active');
                }
            });
        }
        
        // Reviews Management Functions
        function showAddReviewForm() {
            document.getElementById('addReviewForm').style.display = 'block';
            // Set default date to today
            if (!document.getElementById('reviewDate').value) {
                document.getElementById('reviewDate').value = new Date().toISOString().split('T')[0];
            }
        }
        
        function cancelAddReview() {
            document.getElementById('addReviewForm').style.display = 'none';
            document.getElementById('reviewName').value = '';
            document.getElementById('reviewRating').value = '5';
            document.getElementById('reviewComment').value = '';
            document.getElementById('reviewDate').value = '';
            document.getElementById('reviewVerified').checked = false;
        }
        
        // Reviews management - use window scope
        if (!window.productReviews) {
            window.productReviews = [];
        }
        
        function addReview() {
            const name = document.getElementById('reviewName').value.trim();
            const rating = parseInt(document.getElementById('reviewRating').value);
            const comment = document.getElementById('reviewComment').value.trim();
            const date = document.getElementById('reviewDate').value;
            const verified = document.getElementById('reviewVerified').checked;
            
            if (!name || !comment) {
                alert('Please fill in reviewer name and comment');
                return;
            }
            
            const review = {
                id: 'review-' + Date.now() + '-' + Math.random().toString(36).substr(2, 5),
                name: name,
                rating: rating,
                comment: comment,
                date: date || new Date().toISOString().split('T')[0],
                verified: verified,
                createdAt: new Date().toISOString()
            };
            
            window.productReviews.push(review);
            renderReviewsList();
            cancelAddReview();
        }
        
        function deleteReview(reviewId) {
            if (confirm('Are you sure you want to delete this review?')) {
                window.productReviews = window.productReviews.filter(r => r.id !== reviewId);
                renderReviewsList();
            }
        }
        
        function renderReviewsList() {
            const container = document.getElementById('reviewsList');
            if (!container) return;
            
            const reviews = window.productReviews || [];
            
            if (reviews.length === 0) {
                container.innerHTML = '<p style="color: #666; text-align: center; padding: 2rem;">No reviews yet. Add your first review!</p>';
                return;
            }
            
            container.innerHTML = reviews.map(review => {
                const stars = Array.from({length: 5}, (_, i) => 
                    i < review.rating ? '<i class="fas fa-star"></i>' : '<i class="far fa-star"></i>'
                ).join('');
                
                const dateStr = formatReviewDate(review.date || review.createdAt);
                
                return `
                    <div class="review-item-admin">
                        <div class="review-item-header">
                            <div class="review-item-info">
                                <span class="review-item-name">${review.name}</span>
                                <div class="review-item-stars">${stars}</div>
                                ${review.verified ? '<span class="review-item-verified">Verified Purchase</span>' : ''}
                                <span class="review-item-date">${dateStr}</span>
                            </div>
                            <div class="review-item-actions">
                                <button class="btn btn-delete btn-sm" onclick="deleteReview('${review.id}')">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                            </div>
                        </div>
                        <div class="review-item-comment">${review.comment}</div>
                    </div>
                `;
            }).join('');
        }
        
        function formatReviewDate(dateStr) {
            if (!dateStr) return '';
            const date = new Date(dateStr);
            const now = new Date();
            const diffTime = Math.abs(now - date);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays === 0) return 'Today';
            if (diffDays === 1) return 'Yesterday';
            if (diffDays < 7) return `${diffDays} days ago`;
            if (diffDays < 30) return `${Math.floor(diffDays / 7)} weeks ago`;
            if (diffDays < 365) return `${Math.floor(diffDays / 30)} months ago`;
            return date.toLocaleDateString();
        }
        
        function generateRandomReviews() {
            const count = prompt('How many random reviews would you like to generate?', '10');
            if (!count || isNaN(count) || count < 1) return;
            
            const names = [
                'Sarah M.', 'Emma L.', 'Jessica K.', 'Michael B.', 'David R.', 
                'Jennifer W.', 'Amanda T.', 'Robert H.', 'Lisa P.', 'Chris D.',
                'Maria G.', 'James S.', 'Patricia F.', 'Daniel M.', 'Linda C.',
                'Thomas A.', 'Barbara J.', 'Richard L.', 'Susan N.', 'Joseph K.'
            ];
            
            const positiveComments = [
                'Absolutely love this product! The quality is outstanding and it looks even better in person.',
                'Great purchase! The design is elegant and it\'s very comfortable. Highly recommend!',
                'Excellent quality for the price. Fast shipping and great customer service.',
                'Beautiful product! Exactly as described. Very satisfied with my purchase.',
                'Amazing quality! Worth every penny. Will definitely buy again.',
                'Perfect! Exceeded my expectations. The quality is top-notch.',
                'Love it! Great value for money. Highly satisfied with this purchase.',
                'Wonderful product! Fast delivery and excellent packaging. Very happy!',
                'Outstanding quality! Looks great and feels premium. Highly recommend!',
                'Excellent product! Exactly what I was looking for. Very pleased!'
            ];
            
            const neutralComments = [
                'Good product overall. Quality is decent for the price.',
                'Nice product, but could be better. Still satisfied with purchase.',
                'It\'s okay. Nothing special but does the job.',
                'Average quality. Expected more for the price.',
                'Decent product. Not bad but not great either.'
            ];
            
            const negativeComments = [
                'Not as expected. Quality could be better.',
                'Disappointed with the quality. Expected more for this price.',
                'Not satisfied. The product doesn\'t match the description.'
            ];
            
            for (let i = 0; i < parseInt(count); i++) {
                const rating = Math.random() < 0.7 ? 
                    (Math.random() < 0.8 ? 5 : 4) : 
                    (Math.random() < 0.7 ? 3 : (Math.random() < 0.8 ? 2 : 1));
                
                let comment;
                if (rating >= 4) {
                    comment = positiveComments[Math.floor(Math.random() * positiveComments.length)];
                } else if (rating === 3) {
                    comment = neutralComments[Math.floor(Math.random() * neutralComments.length)];
                } else {
                    comment = negativeComments[Math.floor(Math.random() * negativeComments.length)];
                }
                
                const name = names[Math.floor(Math.random() * names.length)];
                const daysAgo = Math.floor(Math.random() * 180); // Random date within last 6 months
                const date = new Date();
                date.setDate(date.getDate() - daysAgo);
                
                const review = {
                    id: 'review-' + Date.now() + '-' + i + '-' + Math.random().toString(36).substr(2, 5),
                    name: name,
                    rating: rating,
                    comment: comment,
                    date: date.toISOString().split('T')[0],
                    verified: Math.random() > 0.4, // 60% verified
                    createdAt: date.toISOString()
                };
                
                if (!window.productReviews) window.productReviews = [];
                window.productReviews.push(review);
            }
            
            renderReviewsList();
            alert(`Generated ${count} random reviews!`);
        }
    </script>
    <script>
        // Configure AliExpress API
        // Option 1: Use backend API proxy on Render (recommended)
        // Replace YOUR_API_URL with your Render service URL
        // Example: https://aliexpress-api-elxt.onrender.com
        
        // Uncomment and set your Render API URL below:
        window.aliConfig = { 
            apiBase: 'https://aliexpress-api-elxt.onrender.com/api/aliexpress', // Your Render API URL
            useCorsProxy: false, // Disable CORS proxy when using backend API
            corsProxy: 'https://api.allorigins.win/get?url=' // CORS proxy service (fallback only)
        };
        
        // If you want to use direct fetching instead (without backend), comment above and use:
        // window.aliConfig = { 
        //     apiBase: '',
        //     useCorsProxy: true,
        //     corsProxy: 'https://api.allorigins.win/get?url='
        // };
    </script>
    <script src="js/aliexpress.js"></script>
    <script src="js/admin.js"></script>
</body>
</html>

